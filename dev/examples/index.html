<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · LibSSH</title><meta name="title" content="Examples · LibSSH"/><meta property="og:title" content="Examples · LibSSH"/><meta property="twitter:title" content="Examples · LibSSH"/><meta name="description" content="Documentation for LibSSH."/><meta property="og:description" content="Documentation for LibSSH."/><meta property="twitter:description" content="Documentation for LibSSH."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">LibSSH</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">LibSSH.jl</a></li><li class="is-active"><a class="tocitem" href>Examples</a></li><li><a class="tocitem" href="../sessions_and_channels/">Sessions and Channels</a></li><li><a class="tocitem" href="../server_support/">Server support</a></li><li><a class="tocitem" href="../utilities/">Utilities</a></li><li><a class="tocitem" href="../bindings/">Low-level bindings</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JamesWrigley/LibSSH.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JamesWrigley/LibSSH.jl/blob/master/docs/src/examples.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="A-simple-client"><a class="docs-heading-anchor" href="#A-simple-client">A simple client</a><a id="A-simple-client-1"></a><a class="docs-heading-anchor-permalink" href="#A-simple-client" title="Permalink"></a></h1><p>First we&#39;ll import the LibSSH package:</p><pre><code class="language-julia hljs">import LibSSH as ssh</code></pre><p>Sadly there aren&#39;t many publicly available SSH servers out there so we&#39;ll start our own <a href="../server_support/#Demo-server">Demo server</a> locally with a Very Secure™ password:</p><pre><code class="language-julia hljs">import LibSSH.Demo as demo

demo_server = demo.DemoServer(2222; password=&quot;foo&quot;, auth_methods=[ssh.AuthMethod_Password])
demo.start(demo_server)</code></pre><p>This is just to have something to play with. Now we can create a <a href="../sessions_and_channels/#LibSSH.Session"><code>Session</code></a> to connect to the server:</p><pre><code class="language-julia hljs">session = ssh.Session(&quot;127.0.0.1&quot;, 2222)
@assert ssh.isconnected(session)</code></pre><p>And we have a connection! That means that the key exchange between us and the server has finished and we can communicate securely. But we still don&#39;t know that the server is who it says it is so the next step is authentication <em>of the server</em>, which means checking its host key. The easiest way to do this is by checking the server key against the users known hosts file:</p><pre><code class="language-julia hljs">ssh.is_known_server(session; throw_on_failure=false)</code></pre><pre><code class="nohighlight hljs">KnownHosts_Unknown::KnownHosts = 0</code></pre><p>Ok, we got back a <code>KnownHosts_Unknown</code> response. That&#39;s because the demo server automatically creates a dummy key to use, and that definitely won&#39;t be in the known hosts file. If host verification fails a good client should prompt the user with the key fingerprint and ask them what to do. We can get the key from the session, hash it, and compute a fingerprint:</p><pre><code class="language-julia hljs">import LibSSH.PKI as pki

host_key = ssh.get_server_publickey(session)
sha256_hash = pki.get_publickey_hash(host_key)
fingerprint = pki.get_fingerprint_hash(sha256_hash)</code></pre><pre><code class="nohighlight hljs">&quot;SHA256:bvcNMpwz7i6TteHM2j5BsQXq5I8D1rGeTw+yobZIbMg&quot;</code></pre><p>Or convert it to a hex string with <a href="../utilities/#LibSSH.get_hexa"><code>get_hexa()</code></a>:</p><pre><code class="language-julia hljs">hex = ssh.get_hexa(sha256_hash)</code></pre><pre><code class="nohighlight hljs">&quot;6e:f7:0d:32:9c:33:ee:2e:93:b5:e1:cc:da:3e:41:b1:05:ea:e4:8f:03:d6:b1:9e:4f:0f:b2:a1:b6:48:6c:c8&quot;</code></pre><p>Since this is a dummy key from the demo server we don&#39;t really want to add it to our known hosts file, but if this was asked to the user and they said yes, it should be added to the known hosts using <a href="../sessions_and_channels/#LibSSH.update_known_hosts"><code>update_known_hosts()</code></a>. But since it&#39;s a dummy key let&#39;s just trust it and continue with authenticating ourselves to the server.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>Don&#39;t skip host verification. It&#39;s the only part of the protocol that libssh doesn&#39;t handle for you, and security cannot be guaranteed without it.</p></div></div><p>Since we created the server we already know that it supports password authentication, but a good client should check anyway:</p><pre><code class="language-julia hljs">ssh.userauth_list(session)</code></pre><pre><code class="nohighlight hljs">1-element Vector{LibSSH.AuthMethod}:
 AuthMethod_Password::AuthMethod = 2</code></pre><p>If we give the wrong password we&#39;ll get denied:</p><pre><code class="language-julia hljs">@assert ssh.userauth_password(session, &quot;quux&quot;) == ssh.AuthStatus_Denied</code></pre><p>But the right password should succeed:</p><pre><code class="language-julia hljs">@assert ssh.userauth_password(session, &quot;foo&quot;) == ssh.AuthStatus_Success</code></pre><p>Now we&#39;re authenticated to the server and we can actually do something, like running a command:</p><pre><code class="language-julia hljs">ssh.execute(session, &quot;echo &#39;Hello world!&#39;&quot;)</code></pre><pre><code class="nohighlight hljs">(0, &quot;Hello world!\n&quot;)</code></pre><p>What we get back is a tuple of the return code and the output from the command.</p><p>Now we can disconnect our client session:</p><pre><code class="language-julia hljs">close(session)</code></pre><p>And stop the server:</p><pre><code class="language-julia hljs">demo.stop(demo_server)</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« LibSSH.jl</a><a class="docs-footer-nextpage" href="../sessions_and_channels/">Sessions and Channels »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Sunday 28 January 2024 19:29">Sunday 28 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
